@{
    ViewData["Title"] = "V√≤ng Quay Voucher";
    Layout = "~/Views/Shared/_Layout.cshtml";
}

<div class="spinwheel-page" style="background: linear-gradient(rgba(255, 255, 255, 0.7), rgba(255, 255, 255, 0.7)), url('@Url.Content("~/images/Checkout/background2.jpg")'); background-size: cover; background-position: center; background-attachment: fixed;">
    <!-- Background Effects -->
    <div class="spinwheel-bg">
        <div class="floating-particles"></div>
        <div class="gradient-overlay"></div>
    </div>

    <div class="container-fluid">
        <div class="row justify-content-center min-vh-100 align-items-center">
            <div class="col-12 col-xl-10">
                <div class="spinwheel-container">
                    <!-- Header Section -->
                    <div class="spinwheel-header text-center mb-5">
                        <div class="header-icon">
                            <i class="fas fa-bullseye"></i>
                        </div>
                        <h1 class="spinwheel-title">
                            <span class="title-main">V√≤ng Quay Voucher</span>
                            <span class="title-sub">Quay v√≤ng ƒë·ªÉ nh·∫≠n voucher gi·∫£m gi√° h·∫•p d·∫´n!</span>
                        </h1>
                        <div class="header-info">
                            <div class="info-box">
                                <i class="fas fa-info-circle me-2"></i>
                                M·ªói kh√°ch h√†ng ƒë∆∞·ª£c quay 3 l·∫ßn/ng√†y. Voucher c√≥ hi·ªáu l·ª±c trong 24 gi·ªù.
                            </div>
                        </div>
                        <div class="header-stats">
                            <div class="stat-item">
                                <span class="stat-number" id="remainingSpins">@ViewBag.RemainingSpins</span>
                                <span class="stat-label">L∆∞·ª£t quay c√≤n l·∫°i</span>
                            </div>
                            <div class="stat-item">
                                <span class="stat-number">@ViewBag.DailySpins</span>
                                <span class="stat-label">L∆∞·ª£t quay/ng√†y</span>
                            </div>
                        </div>

                        <!-- Reset Button for Testing -->
                        @if (ViewBag.IsLoggedIn == true)
                        {
                            <div class="text-center mt-3">
                                <button type="button" class="btn btn-warning btn-sm" id="resetSpinsBtn">
                                    <i class="fas fa-refresh me-2"></i>Reset s·ªë l·∫ßn quay (Test)
                                </button>
                                <button type="button" class="btn btn-info btn-sm ms-2" id="fixSpinNumbersBtn">
                                    <i class="fas fa-tools me-2"></i>S·ª≠a SpinNumber (Admin)
                                </button>
                                <button type="button" class="btn btn-secondary btn-sm ms-2" id="testSessionBtn">
                                    <i class="fas fa-vial me-2"></i>Test Session
                                </button>
                            </div>
                        }
                    </div>

                    <!-- Main Wheel Section -->
                    <div class="wheel-section">
                        <div class="wheel-container">
                            <!-- Wheel Background -->
                            <div class="wheel-bg">
                                <div class="wheel-ring outer-ring"></div>
                                <div class="wheel-ring middle-ring"></div>
                                <div class="wheel-ring inner-ring"></div>
                            </div>

                            <!-- Spin Wheel -->
                            <div class="spin-wheel" id="spinWheel">
                                <!-- Sectors will be generated by JavaScript -->
                            </div>

                            <!-- Center Circle - N√∫t quay -->
                            <div class="wheel-center" id="spinBtn">
                                <i class="fas fa-play center-logo"></i>
                                <div class="center-text">QUAY NGAY</div>
                            </div>

                            <!-- Pointer -->
                            <div class="wheel-pointer">
                                <div class="pointer-triangle"></div>
                                <div class="pointer-shadow"></div>
                            </div>

                            <!-- Sparkle Effects -->
                            <div class="sparkles">
                                <div class="sparkle sparkle-1"></div>
                                <div class="sparkle sparkle-2"></div>
                                <div class="sparkle sparkle-3"></div>
                                <div class="sparkle sparkle-4"></div>
                            </div>
                        </div>
                    </div>

                    <!-- Instructions Section -->
                    <div class="instructions-section mt-5">
                        <h3 class="text-center mb-4" style="color: #d9534f;">H∆∞·ªõng d·∫´n ch∆°i</h3>
                        <div class="instructions-grid">
                            <div class="instruction-card">
                                <div class="card-icon"><i class="fas fa-hand-pointer"></i></div>
                                <h5 class="card-title">B∆∞·ªõc 1</h5>
                                <p class="card-text">Nh·∫•n n√∫t "QUAY NGAY" ƒë·ªÉ b·∫Øt ƒë·∫ßu v√≤ng quay.</p>
                            </div>
                            <div class="instruction-card">
                                <div class="card-icon"><i class="fas fa-hourglass-half"></i></div>
                                <h5 class="card-title">B∆∞·ªõc 2</h5>
                                <p class="card-text">Ch·ªù v√≤ng quay d·ª´ng v√† xem k·∫øt qu·∫£.</p>
                            </div>
                            <div class="instruction-card">
                                <div class="card-icon"><i class="fas fa-gift"></i></div>
                                <h5 class="card-title">B∆∞·ªõc 3</h5>
                                <p class="card-text">Nh·∫≠n voucher v√† √°p d·ª•ng khi thanh to√°n.</p>
                            </div>
                            <div class="instruction-card">
                                <div class="card-icon"><i class="fas fa-calendar-alt"></i></div>
                                <h5 class="card-title">B∆∞·ªõc 4</h5>
                                <p class="card-text">Quay l·∫°i v√†o ng√†y mai ƒë·ªÉ c√≥ th√™m l∆∞·ª£t quay.</p>
                            </div>
                        </div>
                    </div>

                    <!-- Voucher List Section -->
                    <div class="voucher-list-section mt-5">
                        <h3 class="text-center mb-4" style="color: #d9534f;">üéÅ C√°c voucher c√≥ th·ªÉ tr√∫ng</h3>
                        <div class="voucher-list" id="voucherList">
                            <!-- Voucher cards will be generated by JavaScript -->
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>

<!-- Result Modal - Outside all containers for full screen display -->
<div class="result-modal" id="resultModal">
    <div class="modal-backdrop"></div>
    <div class="modal-content">
        <div class="modal-header">
            <h5 class="modal-title">üéâ K·∫øt qu·∫£ quay th∆∞·ªüng</h5>
            <button type="button" class="btn-close" id="closeModal" aria-label="Close">
                <i class="fas fa-times"></i>
            </button>
        </div>
        <div class="modal-body text-center">
            <div id="resultContent"></div>
        </div>
        <div class="modal-footer">
            <button type="button" class="btn btn-secondary" id="closeModalBtn">ƒê√≥ng</button>
            <button type="button" class="btn btn-info" id="saveVoucherBtn" style="display: none;">
                <i class="fas fa-save me-2"></i>L∆∞u voucher
            </button>
            <button type="button" class="btn btn-success" id="applyVoucherBtn" style="display: none;">
                <i class="fas fa-check-circle me-2"></i>√Åp d·ª•ng voucher
            </button>
        </div>
    </div>
</div>

<script src="~/js/SpinWheel.js" asp-append-version="true"></script>